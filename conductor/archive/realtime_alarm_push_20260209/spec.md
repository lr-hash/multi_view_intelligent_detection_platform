# Specification - 实时异常报警推送机制 (WebSocket)

## 1. 概述
本轨道旨在通过 WebSocket 技术实现报警信息的“秒级”推送。当系统集成模块检测到异常并生成报警记录时，后端将立即通过长连接将详情推送到所有在线的前端客户端，确保监控人员能够第一时间获知风险并采取行动。

## 2. 需求分析
### 2.1 后端 WebSocket 通信 (Flask-SocketIO)
- **长连接管理**：集成 `Flask-SocketIO`，支持客户端连接、断开及身份验证（基于 JWT）。
- **报警广播逻辑**：在 `auxiliary_service.py` 触发报警后，调用 SocketIO 实例向 `alarms` 频道广播报警载荷。

### 2.2 前端实时响应 (Socket.io-client)
- **全局连接**：在应用根节点（`App.vue` 或专用 Store）建立持久 WebSocket 连接。
- **监听与提醒**：监听 `new_alarm` 事件，收到数据后触发全局弹窗通知（Toast/Modal）。
- **自动重连**：实现基础的指数退避重连机制。

### 2.3 交互体验
- **报警弹窗**：显示报警级别、类型、时间及描述，提供“查看详情”快捷跳转。
- **状态指示**：在页面顶部显示当前 WebSocket 连接状态。

## 3. 验收标准
- [ ] 后端集成 `Flask-SocketIO` 并能正常启动服务。
- [ ] 前端成功建立 WebSocket 连接并在 Console 中看到连接成功日志。
- [ ] 模拟触发报警时，所有在线前端页面均能弹出实时提醒，无需手动刷新。
- [ ] 认证失败的客户端无法建立 WebSocket 连接。
